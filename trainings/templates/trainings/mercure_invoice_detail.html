{% extends "trainings/base.html" %}
{% block title %}DÃ©tail facture â€” Mercure{% endblock %}
{% block body_class %}home-gradient no-scroll{% endblock %}

{% block content %}
<div style="max-width:980px; margin:110px auto 40px; padding:0 16px; color:rgba(255,255,255,.92);">
  <div style="padding:16px; border-radius:18px; border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.05);">
    <div style="display:flex; justify-content:space-between; gap:12px; align-items:flex-start;">
      <div>
        <h1 style="margin:0; font-weight:950;">ğŸ§¾ Facture â€” {{ inv.reference|default:"â€”" }}</h1>
        <div style="opacity:.75; margin-top:6px;">
          Formateur : {{ inv.trainer }} â€¢ Statut : {{ inv.get_status_display }}
        </div>
      </div>
      <a class="hbtn" href="{% url 'trainings:dashboard_mercure_paiements' %}">â† Retour</a>
    </div>
  </div>

  <div style="margin-top:14px; display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
    <div style="padding:16px; border-radius:18px; border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.20);">
      <div style="font-weight:950; margin-bottom:10px;">Informations</div>
      <div style="display:grid; gap:8px; font-size:14px;">
        <div><span style="opacity:.7;">Montant HT :</span> <strong>{{ inv.amount_ht }} â‚¬</strong></div>
        <div><span style="opacity:.7;">ReÃ§ue le :</span> <strong>{{ inv.received_date|date:"d/m/Y"|default:"â€”" }}</strong></div>
        <div><span style="opacity:.7;">Ã‰chÃ©ance :</span> <strong>{{ inv.due_date|date:"d/m/Y"|default:"â€”" }}</strong></div>
        <div><span style="opacity:.7;">PayÃ©e le :</span> <strong>{{ inv.paid_date|date:"d/m/Y"|default:"â€”" }}</strong></div>
        <div>
          <span style="opacity:.7;">Retard :</span>
          {% if inv.is_overdue %}
            <span class="pill pill--red">Oui</span>
          {% else %}
            <span class="pill pill--green">Non</span>
          {% endif %}
        </div>
      </div>

      <div style="margin-top:12px;">
        {% if inv.document_path %}
          <a class="hbtn" target="_blank" rel="noopener" href="{% url 'trainings:mercure_invoice_open' inv.id %}">ğŸ‘ï¸ Ouvrir la facture</a>
        {% endif %}
      </div>
    </div>

    <div style="padding:16px; border-radius:18px; border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.20);">
      <div style="font-weight:950; margin-bottom:10px;">Session liÃ©e</div>
      {% if inv.session %}
        <div style="font-weight:950;">{{ inv.session.reference|default:"Session" }} â€” {{ inv.session.client }}</div>
        <div style="opacity:.75; margin-top:6px;">
          ğŸ“… {{ inv.session.start_date|date:"d/m/Y" }} â†’ {{ inv.session.end_date|date:"d/m/Y" }}
          {% if inv.session.training %} â€¢ {{ inv.session.training }}{% endif %}
        </div>
        <div style="margin-top:10px;">
          <a class="hbtn" href="/admin/trainings/session/{{ inv.session.id }}/change/">Ouvrir session (admin)</a>
        </div>
      {% else %}
        <div style="opacity:.7;">â€”</div>
      {% endif %}
    </div>

    <div style="grid-column:1 / -1; padding:16px; border-radius:18px; border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.20);">
      <div style="font-weight:950; margin-bottom:10px;">Notes</div>
      <div style="opacity:.85; white-space:pre-wrap;">{{ inv.notes|default:"â€”" }}</div>
    </div>
  </div>
</div>
{% endblock %}